<?php
include 'db_connect.php'; include 'auth.php';
?>
<!DOCTYPE html>
<html lang="en">
<head>
<?php include('header.php') ?>
<?>
<title>Home |Online Quiz System</title>
</head><body>
<?php
include 'nav_bar.php'

<div class="container-fluid admin">
<div class="card col-md-5 offset-2">
<div class="card-body">
<table class="table table-striped">
<thead>
<th>Quiz</th>
<th>Items</th>
<?php if($_SESSION['login_user_type'] == 3): ?>
<th>Status</th>
<?php else: ?>
<th>Had Taken</th>
<?php endif; ?>
</thead>
<tbody>
<?php
$where = ''; if($_SESSION['login_user_type']
== 2){
$where = " where u.id = ".$_SESSION['login_id']." ";
}
if($_SESSION['login_user_type'] == 3){
$where	=	"	where	q.id	in	(SELECT	quiz_id	from	quiz_student_list	where	user_id	=	'".
$_SESSION['login_id']."') ";
}










<?>

$qry = $conn->query("SELECT q.*,u.name as fname from quiz_list q left join users u on q.user_id = u.id ".$where." order by q.title asc ");
while($row= $qry->fetch_assoc()){
$items = $conn->query("SELECT count(id) as item_count from questions where qid = '".$row['id']."' ")-
>fetch_array()['item_count'];
$swhere =''; if($_SESSION['login_user_type'] == 3)

<div class="container-fluid admin">
<div class="card col-md-5 offset-2">
<div class="card-body">
<table class="table table-striped">
<thead>
<th>Quiz</th>
<th>Items</th>
<?php if($_SESSION['login_user_type'] == 3): ?>
<th>Status</th>
<?php else: ?>
<th>Had Taken</th>
<?php endif; ?>
</thead>
<tbody>
<?php
$where = ''; if($_SESSION['login_user_type']
== 2){
$where = " where u.id = ".$_SESSION['login_id']." ";
}
if($_SESSION['login_user_type'] == 3){
$where	=	"	where	q.id	in	(SELECT	quiz_id	from	quiz_student_list	where	user_id	=	'".
$_SESSION['login_id']."') ";
}
$qry = $conn->query("SELECT q.*,u.name as fname from quiz_list q left join users u on q.user_id = u.id ".$where." order by q.title asc ");
while($row= $qry->fetch_assoc()){
$items = $conn->query("SELECT count(id) as item_count from questions where qid = '".$row['id']."' ")-
>fetch_array()['item_count']
<?>

<div class="container-fluid admin">
<div class="card col-md-5 offset-2">
<div class="card-body">
<table class="table table-striped">
<thead>
<th>Quiz</th>
<th>Items</th>
<?php if($_SESSION['login_user_type'] == 3): ?>
<th>Status</th>
<?php else: ?>
<th>Had Taken</th>
<?php endif; ?>
</thead>
<tbody>
<?php
$where = ''; if($_SESSION['login_user_type']
== 2){
$where = " where u.id = ".$_SESSION['login_id']." ";
}
if($_SESSION['login_user_type'] == 3){
$where	=	"	where	q.id	in	(SELECT	quiz_id	from	quiz_student_list	where	user_id	=	'".
$_SESSION['login_id']."') ";
}
$qry = $conn->query("SELECT q.*,u.name as fname from quiz_list q left join users u on q.user_id = u.id ".$where." order by q.title asc ");
while($row= $qry->fetch_assoc()){
$items = $conn->query("SELECT count(id) as item_count from questions where qid = '".$row['id']."' ")-
>fetch_array()['item_count'];
$swhere =''; if($_SESSION['login_user_type'] == 3)
$swhere= ' and user_id = '.$_SESSION['login_id'].' '
$taken = $conn->query("SELECT count(id) as item_count from answers where quiz_id = '".$row['id']."' ".
$swhere )->fetch_array()['item_count'];
?>
<tr>
<td><?php echo $row['title'] ?></td>
<td class='text-center'><?php echo $items ?></td>
<?php if($_SESSION['login_user_type'] == 3): ?>
<td class='text-center'><?php echo $taken > 1 ? 'Taken' : 'pending' ?></td>
<?php else: ?>
<td class='text-center'><?php echo $taken ?></td>
<?php endif; ?>
</tr>
<?php
}


?>
</body>
</table>
</div>
</div>
</div>
</body>
</html>
Nav_bar
<nav class = "navbar navbar-header navbar-light bg-primary">
<div class = "container-fluid">
<div class = "navbar-header">
<p class = "navbar-text pull-right text-white"><h3>Online Quiz System</h3></p>
</div>
<div class = "nav navbar-nav navbar-right">
<a href="logout.php" class="text-dark">Logout <i class="fa fa-power-off"></i> </a>
</div>
</div>
</nav>
<div id="sidebar" class="bg-light">
<div id="sidebar-field">
<a href="home.php" class="sidebar-item text-dark">
<div class="sidebar-icon"><i class="fa fa-home"> </i></div> Home
</a>
</div>
<?php if($_SESSION['login_user_type'] != 3): ?>
<?php if($_SESSION['login_user_type'] == 1): ?>
<div id="sidebar-field">
<a href="faculty.php" class="sidebar-item text-dark">
<div class="sidebar-icon"><i class="fa fa-users"> </i></div> Faculty List
</a>
</div>
<?php endif; ?>
<div id="sidebar-field">
<a href="student.php" class="sidebar-item text-dark">
<div class="sidebar-icon"><i class="fa fa-users"> </i></div> Student List
</a>
</div>
<div id="sidebar-field">
<a href="quiz.php" class="sidebar-item text-dark">
<div class="sidebar-icon"><i class="fa fa-list"> </i></div> Quiz List
</a>
</div>
<div id="sidebar-field">
<a href="history.php" class="sidebar-item text-dark">
<div class="sidebar-icon"><i class="fa fa-history"> </i></div> Quiz Records
</a>
</div>
<?php else: ?>
<div id="sidebar-field">
<a href="student_quiz_list.php" class="sidebar-item text-dark">
<div class="sidebar-icon"><i class="fa fa-list"> </i></div> Quiz List
</a>
</div>
<?php endif; ?>
</div>
<script>
$(document).ready(function(){ var loc = window.location.href; loc.split('{/}')
$('#sidebar a').each(function(){
// console.log(loc.substr(loc.lastIndexOf("/") + 1),$(this).attr('href')) if($(this).attr('href') == loc.substr(loc.lastIndexOf("/") + 1)){
$(this).addClass('active')
}
})
})


</script>
